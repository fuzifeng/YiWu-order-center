Memcached基础信息
    key的最大长度：250字符，250是memcached服务器端内部限制；某些情况可以超过，比如使用客户端支持前缀+key的形式，那么长度可能超过250.
    单个value最大：1M。
        原因：slab内存管理机制
            内存分配以slab为单位，默认情况下每个slab为1M；
            memcached会把一个slab分割成一个个chunk，用来存item，这些chunk大小不一样，为了满足不同大小的item。



分布式集群如何实现：
    特殊说明：集群与web服务集群不一样，每台Memcached机器存有部分数据。
    a 程序端实现：程序加载所有mc机器的ip列表，通过对key做hash（一致性哈希算法），将数据存在对应mc机器上
    b 负载均衡器：通过对key做hash（一致性哈希算法）
    一致性哈希算法：
        目的：保证每个对象只请求一个对应的服务器，而且当节点宕机的时候，缓存服务器的更新重新分配比例降到最低
        步骤：
            1 求出mc节点hash值，并将其分配到2^32的圆上
            2 采用同样kv键值对中键的hash，映射到相同的圆上
            3 从映射位置顺时针查找，保存到第一个mc服务器
        分配比例降到最低：只会影响新增服务器位置到逆时针方向第一台机器之间的键值对

        性质：
            平衡性：尽可能分布到所有节点
            单调性：加入新缓冲区后，原有的受影响数据应该在新缓冲区中存在
            分散性：
            负载：负载问题实际上是从另一个角度看待分散性问题
            平滑性：缓存服务器的数目平滑改变和缓存对象的平滑改变是一致的

Memcached服务特点和工作原理
    a 完全基于内存缓存
    b 节点间相互独立
    c C/S模式，C语言编写，总共2000行代码
    d 异步IO模型，使用libEvent作为事件通知机制
    e 数据kv存在
    f 数据全部放在内存，不可存储
    g 缓存数量达到一定数量后，自动使用LRU算法删除过期缓存数据
        LRU：最近最少使用算法，是一种内存数据淘汰策略，使用常见是当内存不足时，需要淘汰最近最少使用的数据
    h 可对存储数据设置过期时间，在访问数据查看key的时候删除
    j memcached会对设定内存分块，再把块分组，然后提供服务


Memcached怎样工作？
    两阶段哈希：第一阶段hash为了获取memcached节点，第二阶段hash为了在节点中获取kv中的value

Memcached最大优势是什么？
    有着极佳的水平扩展能力。Memcached之间没有互相通信，不会增加Memcached的负载；没有多播协议，不会造成网络通信量爆炸


Memcached和服务器的local cache相比的优缺点
    local cache查询速度快，没有网络延迟，但很难做集体失效，每台服务器都需要处理，内存受服务器影响。
    Memcached理论上可以无限扩容

Memcached如何处理容错的？
    不处理。当节点失效、应对措施取决于用户。有以下方案：
    1 忽略。在失效节点恢复前，还有很多其他节点可以应对失效带来的影响
    2 把失效节点从节点列表中移除。会导致很多缓存数据不可用，因为hash值改变
    3 启动热备节点，接管失效节点所占ip。这样可以防止hash紊乱


Memcached是原子性操作吗
    发送到memcached所有的单个命令是完全原子的。针对同一份数据同时发送get和set，互不影响，他们将被串行化。
    命令序列不是原子的。


Memcached与Redis的区别
    1 redis有多种不同的数据类型，memcached只支持简单的数据类型
    2 redis支持数据持久化（aof、rdb），memcached不支持
    3 Memcached的简单限制就是键（key）和Value的限制。最大键长为250个字符。可以接受的储存数据不能超过1MB（可修改配置文件变大），
      因为这是典型slab 的最大值，不适合虚拟机使用。而Redis的Key长度支持到512k。
    4 Redis使用的是单线程模型，保证了数据按顺序提交。Memcached需要使用cas保证数据一致性。
    5 cpu利用。由于Redis只使用单核，而Memcached可以使用多核，所以平均每一个核上Redis在存储小
      数据时比Memcached性能更高。而在100k以上的数据中，Memcached性能要高于Redis。
    6 memcache内存管理：使用Slab Allocation。原理相当简单，预先分配一系列大小固定的组，然后
      根据数据大小选择最合适的块存储。避免了内存碎片。（缺点：不能变长，浪费了一定空间）
      memcached默认情况下下一个slab的最大值为前一个的1.25倍。
    7 redis内存管理： Redis通过定义一个数组来记录所有的内存分配情况， Redis采用的是包装的
      malloc/free，相较于Memcached的内存管理方法来说，要简单很多。由于malloc首先以链表的方式
      搜索已管理的内存中可用的空间分配，导致内存碎片比较多
